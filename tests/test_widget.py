import pytest

from src.widget import get_date, mask_account_card


@pytest.mark.parametrize(
    "user_data, expected",
    [
        # Тесты для банковских карт
        ("Visa Platinum 1234567890123456", "Visa Platinum 1234 56** **** 3456"),
        ("Maestro 1234567812345678", "Maestro 1234 56** **** 5678"),
        ("МИР 1234567890123456", "МИР 1234 56** **** 3456"),
        # Тесты для банковских счетов
        ("Счет 12345678901234567890", "Счет **7890"),
        ("Счет 12345678", "Счет **5678"),
        # Граничные случаи
        ("", ""),
        ("   ", ""),
        ("Счет ", "Счет **"),
        ("Карта 1234", "Карта 1234"),
        ("Just text", "Just text"),
        ("Счет abcdef", "Счет abcdef"),
    ],
)
def test_mask_account_card(user_data, expected):
    assert mask_account_card(user_data) == expected


@pytest.mark.parametrize(
    "date_info, expected",
    [
        # Корректные даты
        ("2023-04-12T10:30:00", "12.04.2023"),
        ("2022-12-31T23:59:59", "31.12.2022"),
        ("2020-01-01", "01.01.2020"),
        # Граничные случаи
        ("", ""),
        ("2023-04", ""),
        ("2023", ""),
        ("abcd-ef-gh", ""),
        ("2023/04/12", ""),
        ("2023-04-12T10:30", ""),  # Неполное время
        # Невалидные даты
        ("2023-13-01", ""),
        ("2023-02-30", ""),
        ("2023-00-15", ""),
        ("2023-04-00", ""),
        # Специальные случаи
        ("0000-01-01", "01.01.0000"),
        ("9999-12-31", "31.12.9999"),
        ("2023-04-12T99:99:99", ""),  # Невалидное время
    ],
)
def test_get_date(date_info, expected):
    assert get_date(date_info) == expected
